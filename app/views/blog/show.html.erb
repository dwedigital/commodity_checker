<% content_for :title, "#{@post.title} - Tariffik Blog" %>

<% content_for :head do %>
  <meta name="description" content="<%= @post.description %>">
  <link rel="canonical" href="<%= blog_post_url(@post.slug) %>">

  <!-- Open Graph -->
  <meta property="og:title" content="<%= @post.title %>">
  <meta property="og:description" content="<%= @post.description %>">
  <meta property="og:type" content="article">
  <meta property="og:url" content="<%= blog_post_url(@post.slug) %>">
  <% if @post.hero_image.present? %>
    <meta property="og:image" content="<%= absolute_image_url(@post.hero_image) %>">
  <% end %>
  <meta property="article:published_time" content="<%= @post.date.iso8601 %>">
  <meta property="article:author" content="<%= @post.author %>">
  <% @post.tags.each do |tag| %>
    <meta property="article:tag" content="<%= tag %>">
  <% end %>

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="<%= @post.title %>">
  <meta name="twitter:description" content="<%= @post.description %>">
  <% if @post.hero_image.present? %>
    <meta name="twitter:image" content="<%= absolute_image_url(@post.hero_image) %>">
  <% end %>

  <!-- JSON-LD -->
  <%= blog_post_json_ld(@post) %>

  <style>
    .prose h2 { margin-top: 2em; margin-bottom: 0.75em; font-size: 1.5rem; font-weight: 600; }
    .prose h3 { margin-top: 1.5em; margin-bottom: 0.5em; font-size: 1.25rem; font-weight: 600; }
    .prose p { margin-bottom: 1.25em; line-height: 1.75; }
    .prose ul, .prose ol { margin-bottom: 1.25em; padding-left: 1.5em; }
    .prose li { margin-bottom: 0.5em; }
    .prose ul { list-style-type: disc; }
    .prose ol { list-style-type: decimal; }
    .prose a { color: #4f46e5; text-decoration: underline; }
    .prose a:hover { color: #3730a3; }
    .prose blockquote { border-left: 4px solid #e5e7eb; padding-left: 1em; margin: 1.5em 0; color: #6b7280; font-style: italic; }
    .prose code { background-color: #f3f4f6; padding: 0.125em 0.25em; border-radius: 0.25em; font-size: 0.875em; }
    .prose pre { background-color: #1f2937; padding: 1em; border-radius: 0.5em; overflow-x: auto; margin: 1.5em 0; }
    .prose pre code { background-color: transparent; padding: 0; color: #e5e7eb; }
    .prose img { border-radius: 0.5em; margin: 1.5em 0; }
    .prose table { width: 100%; border-collapse: collapse; margin: 1.5em 0; }
    .prose th, .prose td { border: 1px solid #e5e7eb; padding: 0.75em; text-align: left; }
    .prose th { background-color: #f9fafb; font-weight: 600; }

    /* Rouge syntax highlighting */
    .highlight { background: #1f2937; }
    .highlight .c, .highlight .c1, .highlight .cm { color: #6b7280; font-style: italic; }
    .highlight .k, .highlight .kd, .highlight .kn, .highlight .kp, .highlight .kr { color: #c084fc; }
    .highlight .s, .highlight .s1, .highlight .s2, .highlight .sb, .highlight .sc { color: #86efac; }
    .highlight .n, .highlight .na, .highlight .nb, .highlight .nc, .highlight .no { color: #93c5fd; }
    .highlight .nf, .highlight .ni { color: #fcd34d; }
    .highlight .o, .highlight .p { color: #e5e7eb; }
    .highlight .m, .highlight .mi, .highlight .mf { color: #f87171; }
  </style>
<% end %>

<article class="max-w-3xl mx-auto">
  <!-- Back link -->
  <div class="mb-8">
    <%= link_to blog_path, class: "inline-flex items-center text-sm text-gray-500 hover:text-indigo-600" do %>
      <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
      </svg>
      Back to blog
    <% end %>
  </div>

  <!-- Hero image -->
  <% if @post.hero_image.present? %>
    <div class="aspect-video rounded-xl overflow-hidden bg-gray-100 mb-8">
      <%= image_tag @post.hero_image, alt: @post.title, class: "w-full h-full object-cover" %>
    </div>
  <% end %>

  <!-- Header -->
  <header class="mb-8">
    <div class="flex items-center gap-2 text-sm text-gray-500 mb-4">
      <time datetime="<%= @post.date.iso8601 %>"><%= @post.date.strftime("%B %d, %Y") %></time>
      <span>&middot;</span>
      <span><%= reading_time(@post.content) %></span>
      <% if @post.author.present? %>
        <span>&middot;</span>
        <span>By <%= @post.author %></span>
      <% end %>
    </div>

    <h1 class="text-4xl font-bold text-gray-900 mb-4"><%= @post.title %></h1>

    <% if @post.description.present? %>
      <p class="text-xl text-gray-600"><%= @post.description %></p>
    <% end %>

    <% if @post.tags.any? %>
      <div class="mt-4 flex flex-wrap gap-2">
        <% @post.tags.each do |tag| %>
          <span class="inline-flex items-center rounded-full bg-indigo-50 px-3 py-1 text-sm font-medium text-indigo-700">
            <%= tag %>
          </span>
        <% end %>
      </div>
    <% end %>
  </header>

  <!-- Content -->
  <div class="prose text-gray-700">
    <%= @post.rendered_content %>
  </div>

  <!-- Footer -->
  <footer class="mt-12 pt-8 border-t border-gray-200">
    <div class="flex items-center justify-between">
      <%= link_to blog_path, class: "inline-flex items-center text-indigo-600 hover:text-indigo-700 font-medium" do %>
        <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        All posts
      <% end %>
    </div>
  </footer>
</article>
