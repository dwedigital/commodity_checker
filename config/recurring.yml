# Solid Queue recurring jobs
# Schedule syntax: https://github.com/rails/solid_queue#recurring-tasks
#
# Examples:
#   every hour
#   every 15 minutes
#   at 5am every day
#   every Monday at 9am
#   on the 1st of every month at midnight

production:
  # Clean up finished Solid Queue jobs to prevent table bloat
  clear_solid_queue_finished_jobs:
    command: "SolidQueue::Job.clear_finished_in_batches(sleep_between_batches: 0.3)"
    schedule: every hour at minute 12

  # Clean up orphaned inbound emails (where order was deleted)
  # Keeps emails for 30 days before deletion to allow recovery
  cleanup_orphaned_emails:
    class: CleanupOrphanedEmailsJob
    args: [{ days_old: 30 }]
    schedule: at 3am every day

staging:
  # Same jobs for staging but can run more frequently for testing
  clear_solid_queue_finished_jobs:
    command: "SolidQueue::Job.clear_finished_in_batches(sleep_between_batches: 0.3)"
    schedule: every hour at minute 12

  cleanup_orphaned_emails:
    class: CleanupOrphanedEmailsJob
    args: [{ days_old: 7 }]
    schedule: at 3am every day
