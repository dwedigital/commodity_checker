# Tariffik Kamal Deployment Configuration (Base)
# ================================================
# This is the base config. Use destination-specific files:
#   kamal setup -d production   → uses deploy.production.yml
#   kamal setup -d staging      → uses deploy.staging.yml
#
# Commands:
#   kamal deploy -d production    # Deploy to production
#   kamal deploy -d staging       # Deploy to staging
#   kamal console -d production   # Rails console
#   kamal logs -d production      # View logs

service: tariffik
image: dwedigital/tariffik

# GitHub Container Registry
registry:
  server: ghcr.io
  username: dwedigital
  password:
    - KAMAL_REGISTRY_PASSWORD

# Build for x86/AMD (Hetzner CPX servers use AMD processors)
builder:
  arch: amd64

# Kamal command aliases
aliases:
  console: app exec --interactive --reuse "bin/rails console"
  shell: app exec --interactive --reuse "bash"
  logs: app logs -f
  dbc: app exec --interactive --reuse "bin/rails dbconsole"

# SSH configuration
ssh:
  keys:
    - ~/.ssh/id_ed25519
